# üöÄ –ù–ê–ß–ù–ò–¢–ï –ó–î–ï–°–¨ - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ OAuth

## üéØ –£ –≤–∞—Å –æ—à–∏–±–∫–∞?
```
Request had invalid authentication credentials. 
Expected OAuth 2 access token
```

**–ù–µ –ø–∞–Ω–∏–∫—É–π—Ç–µ!** –≠—Ç–æ —Ç–∏–ø–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ. –†–µ—à–∞–µ—Ç—Å—è –∑–∞ 5 –º–∏–Ω—É—Ç. ‚úÖ

---

## ‚ö° –≠–∫—Å–ø—Ä–µ—Å—Å-—Ä–µ—à–µ–Ω–∏–µ (–≤—ã–±–µ—Ä–∏—Ç–µ –ø—É—Ç—å):

### üèÉ –ü—É—Ç—å 1: –Ø —Ö–æ—á—É –ë–´–°–¢–†–û –∏—Å–ø—Ä–∞–≤–∏—Ç—å (5 –º–∏–Ω—É—Ç)
‚û°Ô∏è –û—Ç–∫—Ä–æ–π—Ç–µ: **[–ë–´–°–¢–†–û–ï-–†–ï–®–ï–ù–ò–ï-OAuth.md](./–ë–´–°–¢–†–û–ï-–†–ï–®–ï–ù–ò–ï-OAuth.md)**

### üìö –ü—É—Ç—å 2: –Ø —Ö–æ—á—É –ü–û–ù–Ø–¢–¨ –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ (15 –º–∏–Ω—É—Ç)
‚û°Ô∏è –û—Ç–∫—Ä–æ–π—Ç–µ: **[–ò–ù–°–¢–†–£–ö–¶–ò–Ø-OAuth-Setup.md](./–ò–ù–°–¢–†–£–ö–¶–ò–Ø-OAuth-Setup.md)**

### ‚òëÔ∏è –ü—É—Ç—å 3: –î–∞–π—Ç–µ –º–Ω–µ –ß–ï–ö–õ–ò–°–¢ –¥–ª—è –≥–∞–ª–æ—á–µ–∫ (10 –º–∏–Ω—É—Ç)
‚û°Ô∏è –û—Ç–∫—Ä–æ–π—Ç–µ: **[CHECKLIST-OAuth.md](./CHECKLIST-OAuth.md)**

---

## ü§î –ß—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å?

**–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:**

–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Google Sheets, –Ω–æ Google –≥–æ–≤–æ—Ä–∏—Ç: 
> "–ü–æ–¥–æ–∂–¥–∏, –∞ –∫—Ç–æ —Ç—ã? –ü–æ–∫–∞–∂–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ!"

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ —Å–ª–æ–≤–∞–º–∏:**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ Firebase ID token (–¥–ª—è –≤—Ö–æ–¥–∞ –≤ Firebase) –≤–º–µ—Å—Ç–æ OAuth 2.0 access token (–¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Google Sheets API). –≠—Ç–æ —Ä–∞–∑–Ω—ã–µ –≤–µ—â–∏!

---

## ‚úÖ –ß—Ç–æ –º—ã —É–∂–µ —Å–¥–µ–ª–∞–ª–∏ (–≤ –∫–æ–¥–µ):

1. ‚úÖ –£–±—Ä–∞–ª–∏ fallback –Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
2. ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —É—Ç–∏–ª–∏—Ç—ã
3. ‚úÖ –°–æ–∑–¥–∞–ª–∏ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
4. ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

**–¢–µ–ø–µ—Ä—å –≤–∞—à–∞ –æ—á–µ—Ä–µ–¥—å:** –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Google Cloud Console (–æ–¥–∏–Ω —Ä–∞–∑).

---

## üõ† –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å (–∫–æ—Ä–æ—Ç–∫–æ):

### 1. Google Cloud Console (3 –º–∏–Ω—É—Ç—ã)
```
1. –í–∫–ª—é—á–∏—Ç—å Google Sheets API
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å OAuth consent screen
3. –î–æ–±–∞–≤–∏—Ç—å scope –¥–ª—è Sheets
4. –î–æ–±–∞–≤–∏—Ç—å —Å–µ–±—è –∫–∞–∫ test user
```

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ö–æ–¥ (2 –º–∏–Ω—É—Ç—ã)
```
1. Logout –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. Clear localStorage
3. Login —Å–Ω–æ–≤–∞
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å (30 —Å–µ–∫—É–Ω–¥)
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
window.authDiagnostics.logDiagnostics()
```

**–î–µ—Ç–∞–ª–∏:** —Å–º. [–ë–´–°–¢–†–û–ï-–†–ï–®–ï–ù–ò–ï-OAuth.md](./–ë–´–°–¢–†–û–ï-–†–ï–®–ï–ù–ò–ï-OAuth.md)

---

## üß™ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫)

### –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
window.authDiagnostics.checkToken()
```

**–•–æ—Ä–æ—à–æ ‚úÖ:**
```javascript
{
  type: 'oauth',
  isValid: true,
  message: '‚úÖ –í–∞–ª–∏–¥–Ω—ã–π OAuth —Ç–æ–∫–µ–Ω'
}
```

**–ü–ª–æ—Ö–æ ‚ùå:**
```javascript
{
  type: 'id_token',  // ‚ùå –≠—Ç–æ Firebase ID token, –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Sheets
  message: '‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω Firebase ID token...'
}
```

–ï—Å–ª–∏ "–ø–ª–æ—Ö–æ" ‚Üí OAuth –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω ‚Üí —Å–º. [–ë–´–°–¢–†–û–ï-–†–ï–®–ï–ù–ò–ï-OAuth.md](./–ë–´–°–¢–†–û–ï-–†–ï–®–ï–ù–ò–ï-OAuth.md)

---

## üìö –í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (–ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏):

| –î–æ–∫—É–º–µ–Ω—Ç | –î–ª—è –∫–æ–≥–æ | –í—Ä–µ–º—è |
|----------|---------|--------|
| **[–ë–´–°–¢–†–û–ï-–†–ï–®–ï–ù–ò–ï-OAuth.md](./–ë–´–°–¢–†–û–ï-–†–ï–®–ï–ù–ò–ï-OAuth.md)** | –•–æ—á—É –±—ã—Å—Ç—Ä–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å | 5 –º–∏–Ω |
| **[CHECKLIST-OAuth.md](./CHECKLIST-OAuth.md)** | –õ—é–±–ª—é —á–µ–∫–ª–∏—Å—Ç—ã | 10 –º–∏–Ω |
| **[–ò–ù–°–¢–†–£–ö–¶–ò–Ø-OAuth-Setup.md](./–ò–ù–°–¢–†–£–ö–¶–ò–Ø-OAuth-Setup.md)** | –•–æ—á—É –≤—Å—ë –ø–æ–Ω—è—Ç—å | 15 –º–∏–Ω |
| **[OAuth-FIX-SUMMARY.md](./OAuth-FIX-SUMMARY.md)** | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ | 20 –º–∏–Ω |

---

## üÜò –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?
**A:** –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –æ—Ç Google –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –≤–∞—à–∏–º —Ç–∞–±–ª–∏—Ü–∞–º. –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### Q: –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑?
**A:** –ù–µ—Ç! –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø—Ä–æ–µ–∫—Ç–∞.

### Q: –¢–æ–∫–µ–Ω –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤–µ—á–Ω–æ?
**A:** OAuth —Ç–æ–∫–µ–Ω –∂–∏–≤–µ—Ç 1 —á–∞—Å, –ø–æ—Ç–æ–º –Ω—É–∂–Ω–æ –∑–∞–Ω–æ–≤–æ –≤–æ–π—Ç–∏. –≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ Google/Firebase.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–∫–µ–Ω?
**A:** –ù–µ—Ç, –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é. Firebase Auth –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç refresh token –¥–ª—è OAuth. –ù—É–∂–µ–Ω –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—Ö–æ–¥.

### Q: –£ –º–µ–Ω—è –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!
**A:** 
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É: `window.authDiagnostics.logDiagnostics()`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∏–ø —Ç–æ–∫–µ–Ω–∞ - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `oauth`, –Ω–µ `id_token`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ scope –¥–æ–±–∞–≤–ª–µ–Ω –≤ OAuth consent screen
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ
5. –°–º. —Ä–∞–∑–¥–µ–ª "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫" –≤ [–ò–ù–°–¢–†–£–ö–¶–ò–Ø-OAuth-Setup.md](./–ò–ù–°–¢–†–£–ö–¶–ò–Ø-OAuth-Setup.md)

---

## ‚ú® –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ö–æ–≥–¥–∞ –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏:
```
‚úÖ OAuth access token –ø–æ–ª—É—á–µ–Ω
‚úÖ –í—Ö–æ–¥ —á–µ—Ä–µ–∑ popup —É—Å–ø–µ—à–µ–Ω
üì• Products loaded from Google Sheets
```

–ò –≤—Å—ë –±—É–¥–µ—Ç **–ø—Ä–æ—Å—Ç–æ —Ä–∞–±–æ—Ç–∞—Ç—å**! üéâ

---

## üöÄ –ü–æ–µ—Ö–∞–ª–∏!

–í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π –ø—É—Ç—å:
- üèÉ **–ë—ã—Å—Ç—Ä–æ:** [–ë–´–°–¢–†–û–ï-–†–ï–®–ï–ù–ò–ï-OAuth.md](./–ë–´–°–¢–†–û–ï-–†–ï–®–ï–ù–ò–ï-OAuth.md)
- ‚òëÔ∏è **–ß–µ–∫–ª–∏—Å—Ç:** [CHECKLIST-OAuth.md](./CHECKLIST-OAuth.md)
- üìö **–ü–æ–¥—Ä–æ–±–Ω–æ:** [–ò–ù–°–¢–†–£–ö–¶–ò–Ø-OAuth-Setup.md](./–ò–ù–°–¢–†–£–ö–¶–ò–Ø-OAuth-Setup.md)

**–£–¥–∞—á–∏!** üí™

